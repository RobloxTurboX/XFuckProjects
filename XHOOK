local XMT = getrawmetatable(game)
setreadonly(XMT, false)

local XOLD = XMT.__namecall

XMT.__namecall = newcclosure(function(self, ...)
    local XMETHOD = getnamecallmethod()
    local XARGS = {...}
    local XKEY = tostring(self) .. ":" .. XMETHOD

    if not checkcaller() and XHOOKS[XKEY] then
        return nil
    end

    return XOLD(self, ...)
end)

setreadonly(XMT, true)

function XFUCK:XNAMECALL(self, ...)
    local XMETHOD = getnamecallmethod()
    local XARGS = {...}
    local XKEY = tostring(self) .. ":" .. XMETHOD

    if not checkcaller() and XHOOKS[XKEY] then
        return nil
    end

    return XOLD(self, ...)
end

function XFUCK:XHOOK(event, method)
    local XKEY = event .. ":" .. method
    XHOOKS[XKEY] = true
end

function XFUCK:XUNHOOK(event, method)
    local XKEY = event .. ":" .. method
    XHOOKS[XKEY] = nil
end

return XFUCK
